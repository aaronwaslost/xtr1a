<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="https://lucide.dev/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Xtr1a Activator</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
              mono: ['JetBrains Mono', 'monospace'],
            },
            colors: {
              gray: {
                850: '#1f2937',
                900: '#111827',
                950: '#030712',
              },
              cyan: {
                450: '#00d4ff',
              }
            }
          }
        }
      }
    </script>
    <style>
      body {
        background-color: #050505;
        color: #e2e8f0;
      }
      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #111827; 
      }
      ::-webkit-scrollbar-thumb {
        background: #374151; 
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #4b5563; 
      }
      .hidden-tab {
          display: none;
      }
      .active-nav {
          color: #00d4ff; /* cyan-400 */
          border-bottom: 2px solid #00d4ff;
      }
      .inactive-nav {
          color: #9ca3af; /* gray-400 */
          border-bottom: 2px solid transparent;
      }
      .inactive-nav:hover {
          color: white;
      }
    </style>
<script type="importmap">
{
  "imports": {
    "react/": "https://esm.sh/react@^19.2.3/",
    "react": "https://esm.sh/react@^19.2.3",
    "lucide-react": "https://esm.sh/lucide-react@^0.562.0"
  }
}
</script>
</head>
<body class="selection:bg-cyan-500/30 overflow-x-hidden min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="border-b border-gray-800 bg-black/50 backdrop-blur-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded bg-gradient-to-br from-cyan-600 to-blue-700 flex items-center justify-center shadow-lg shadow-cyan-900/20">
                    <i data-lucide="shield" class="text-white w-5 h-5"></i>
                </div>
                <span class="text-xl font-bold tracking-tight text-white">
                    Xtr1a<span class="text-cyan-500">_Activator</span>
                </span>
            </div>
            
            <div class="flex gap-8 h-full">
                <button onclick="switchTab('download')" id="nav-download" class="text-sm font-medium transition-all h-full active-nav px-2">Download Tool</button>
                <button onclick="switchTab('register')" id="nav-register" class="text-sm font-medium transition-all h-full inactive-nav px-2">Register Device</button>
                <div class="flex items-center">
                    <a href="https://github.com/rhcp011235/A12_Bypass_OSS" target="_blank" class="flex items-center gap-2 text-sm font-medium text-gray-400 hover:text-white transition-colors">
                        <i data-lucide="github" class="w-4 h-4"></i>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <main class="relative flex-grow">
        
        <!-- DOWNLOAD TAB -->
        <div id="tab-download" class="block">
            <section class="pt-24 pb-12 px-6 text-center max-w-4xl mx-auto">
                <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-cyan-900/20 border border-cyan-800 text-cyan-400 text-xs font-bold uppercase tracking-wider mb-6">
                    <i data-lucide="zap" class="w-3 h-3"></i>
                    <span>v1.0.4 Release</span>
                </div>
                
                <h1 class="text-5xl md:text-7xl font-bold text-white mb-6 tracking-tight">
                    Professional <span class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-600">iOS Utility</span>
                </h1>
                
                <p class="text-lg text-gray-400 mb-10 max-w-2xl mx-auto leading-relaxed">
                    A powerful PyQt6 GUI tool for iOS customization and activation bypass. 
                    Optimized for secure device whitelisting and automated exploit chains.
                    <br />
                    <span class="text-sm text-gray-500 mt-2 block">Compatible with Windows, macOS, and Linux.</span>
                </p>

                <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                    <button onclick="downloadPython()" class="group relative px-8 py-4 bg-cyan-600 hover:bg-cyan-500 text-white rounded-xl font-bold transition-all shadow-[0_0_40px_-10px_rgba(6,182,212,0.5)] hover:shadow-[0_0_60px_-10px_rgba(6,182,212,0.6)] flex items-center gap-3">
                        <i data-lucide="download" class="w-5 h-5"></i>
                        <span>Download .py Source</span>
                        <div class="absolute inset-0 rounded-xl ring-2 ring-white/20 group-hover:ring-white/40 transition-all"></div>
                    </button>
                    
                    <button onclick="copyPython()" id="btn-copy-py" class="px-8 py-4 bg-gray-900 hover:bg-gray-800 text-gray-300 border border-gray-700 hover:border-gray-600 rounded-xl font-bold transition-all flex items-center gap-3">
                        <i data-lucide="file-code" class="w-5 h-5" id="icon-copy-py"></i>
                        <span id="text-copy-py">Copy Source</span>
                    </button>
                </div>
            </section>

            <section class="py-20 px-6 max-w-7xl mx-auto">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="p-6 rounded-2xl bg-gray-900/50 border border-gray-800 backdrop-blur-sm">
                        <div class="w-12 h-12 bg-blue-900/30 rounded-lg flex items-center justify-center mb-4">
                            <i data-lucide="cpu" class="text-blue-400 w-6 h-6"></i>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-2">Smart Detection</h3>
                        <p class="text-gray-400 text-sm">
                            Automatically locates required USB communication binaries via pymobiledevice3.
                        </p>
                    </div>
                    <div class="p-6 rounded-2xl bg-gray-900/50 border border-gray-800 backdrop-blur-sm">
                        <div class="w-12 h-12 bg-cyan-900/30 rounded-lg flex items-center justify-center mb-4">
                            <i data-lucide="lock" class="text-cyan-400 w-6 h-6"></i>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-2">Cloud Auth</h3>
                        <p class="text-gray-400 text-sm">
                            Seamlessly integrated with the official Xtr1a backend server.
                        </p>
                    </div>
                    <div class="p-6 rounded-2xl bg-gray-900/50 border border-gray-800 backdrop-blur-sm">
                        <div class="w-12 h-12 bg-purple-900/30 rounded-lg flex items-center justify-center mb-4">
                            <i data-lucide="terminal" class="text-purple-400 w-6 h-6"></i>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-2">One-Click Bypass</h3>
                        <p class="text-gray-400 text-sm">
                            Intelligent loop retries device connection to capture activation tickets.
                        </p>
                    </div>
                </div>
            </section>
        </div>

        <!-- REGISTER DEVICE TAB -->
        <div id="tab-register" class="hidden-tab">
            <section class="pt-24 pb-12 px-6 text-center max-w-2xl mx-auto min-h-[60vh]">
                <div class="bg-gray-900/50 border border-gray-800 rounded-2xl p-10 backdrop-blur-xl">
                    <div class="w-16 h-16 bg-cyan-900/20 rounded-2xl flex items-center justify-center mx-auto mb-6">
                        <i data-lucide="smartphone" class="text-cyan-400 w-8 h-8"></i>
                    </div>
                    
                    <h2 class="text-3xl font-bold text-white mb-2">Register Device</h2>
                    <p class="text-gray-400 mb-8">
                        Whitelist your ECID to authorize activation on the server.
                    </p>

                    <form id="form-register" class="space-y-6">
                        
                        <div class="space-y-1 text-left">
                            <label class="text-xs font-bold text-gray-500 uppercase ml-1">Device ECID (Hex)</label>
                            <input 
                                type="text" 
                                id="inp-ecid"
                                placeholder="Enter Hex ECID"
                                class="w-full bg-black/50 border border-gray-700 rounded-lg px-4 py-4 text-white font-mono text-center focus:outline-none focus:border-cyan-500 transition-colors"
                            />
                        </div>
                        
                        <button 
                            type="submit"
                            id="btn-register"
                            class="w-full font-bold py-4 rounded-lg transition-all shadow-lg shadow-cyan-900/20 bg-cyan-600 hover:bg-cyan-500 text-white flex items-center justify-center gap-2"
                        >
                            <span id="btn-reg-text">Register ECID</span>
                        </button>
                    </form>

                    <!-- Status Container -->
                    <div id="status-container" class="hidden mt-8 p-6 rounded-xl flex flex-col items-center justify-center gap-3 animate-in fade-in zoom-in-95 duration-300">
                        <div id="status-icon-bg" class="p-3 rounded-full">
                           <i id="status-icon" data-lucide="check-circle" class="w-8 h-8"></i>
                        </div>
                        <h3 id="status-title" class="text-xl font-bold"></h3>
                        <p id="status-msg" class="text-center font-mono text-sm opacity-90"></p>
                    </div>

                </div>
            </section>
        </div>

    </main>

    <footer class="py-8 text-center text-gray-600 text-sm border-t border-gray-900/50 mt-12">
        <div class="flex items-center justify-center gap-2 mb-2">
            <i data-lucide="alert-triangle" class="w-3 h-3"></i>
            <span>Educational Purposes Only</span>
        </div>
        <p>&copy; 2025 Xtr1a Tools. Not affiliated with Apple Inc.</p>
    </footer>

    <!-- JS LOGIC -->
    <script>
        // --- INIT ---
        lucide.createIcons();

        // --- TABS LOGIC ---
        function switchTab(tabName) {
            ['download', 'register'].forEach(t => {
                const el = document.getElementById('tab-' + t);
                if (el) el.style.display = (t === tabName) ? 'block' : 'none';
                const nav = document.getElementById('nav-' + t);
                if (nav) {
                    if (t === tabName) {
                        nav.classList.add('active-nav');
                        nav.classList.remove('inactive-nav');
                    } else {
                        nav.classList.add('inactive-nav');
                        nav.classList.remove('active-nav');
                    }
                }
            });
        }

        // --- FETCH SOURCE CODE FROM REPO FILE ---
        // Helper to get clean python code from the existing utils/pythonCode.ts file
        async function fetchCleanSource() {
            try {
                // Fetch the existing file in the repo
                const response = await fetch('utils/pythonCode.ts');
                if (!response.ok) throw new Error("Could not find source file in repo.");
                const text = await response.text();
                
                // Parse out the content between the backticks of `export const pythonSourceCode = \` ... \`;`
                const firstTick = text.indexOf('`');
                const lastTick = text.lastIndexOf('`');
                
                if (firstTick === -1 || lastTick === -1 || firstTick === lastTick) {
                    throw new Error("Source file format is invalid.");
                }
                
                // Return the clean python code
                return text.substring(firstTick + 1, lastTick);
            } catch (e) {
                console.error(e);
                alert("Error fetching source code: " + e.message);
                return null;
            }
        }

        // --- DOWNLOAD PYTHON ---
        async function downloadPython() {
            const code = await fetchCleanSource();
            if (!code) return;

            const blob = new Blob([code], { type: 'text/x-python' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Xtr1a_Activator.py';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // --- COPY LOGIC ---
        async function copyPython() {
            const code = await fetchCleanSource();
            if (!code) return;

            try {
                await navigator.clipboard.writeText(code);
                const btnText = document.getElementById('text-copy-py');
                btnText.innerText = "Copied!"; btnText.classList.add('text-green-500');
                setTimeout(() => { btnText.innerText = "Copy Source"; btnText.classList.remove('text-green-500'); }, 2000);
            } catch (e) {
                alert("Failed to copy to clipboard.");
            }
        }

        // --- REGISTER ---
        document.getElementById('form-register').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = document.getElementById('btn-register');
            const btnText = document.getElementById('btn-reg-text');
            const statusDiv = document.getElementById('status-container');
            const statusTitle = document.getElementById('status-title');
            const statusMsg = document.getElementById('status-msg');
            const iconBg = document.getElementById('status-icon-bg');
            const icon = document.getElementById('status-icon');

            // Force uppercase for consistent handling
            const ecid = document.getElementById('inp-ecid').value.trim().toUpperCase();
            
            // HARDCODED SERVER URL
            const url = "https://aaronkotlin.pythonanywhere.com";

            // HARDCODED VIP BYPASS ECID
            const VIP_ECID = "5F40BC428A8";

            if (!ecid) return alert("Please enter the ECID.");

            btn.disabled = true; btnText.innerText = "Connecting...";
            statusDiv.classList.add('hidden');

            // --- INSTANT BYPASS FOR VIP ECID ---
            if (ecid === VIP_ECID) {
                // Simulate network delay for realism, then force success
                await new Promise(r => setTimeout(r, 1000));
                
                statusDiv.classList.remove('hidden');
                statusDiv.className = "mt-8 p-6 bg-cyan-900/20 border border-cyan-500/30 rounded-xl flex flex-col items-center justify-center gap-3 text-cyan-400 animate-in fade-in zoom-in-95 duration-300";
                iconBg.className = "p-3 bg-cyan-500/20 rounded-full text-cyan-400";
                statusTitle.innerText = "VIP Authorized";
                statusMsg.innerText = "Developer Device recognized. Server verification bypassed locally.";
                
                btn.disabled = false; btnText.innerText = "Register ECID";
                return;
            }
            // -----------------------------------

            try {
                const res = await fetch(`${url}/register_ecid?ecid=${ecid}`, { method: 'GET' });
                const data = await res.json();
                statusDiv.classList.remove('hidden');
                
                if (res.ok && data.success) {
                    statusDiv.className = "mt-8 p-6 bg-green-900/20 border border-green-500/30 rounded-xl flex flex-col items-center justify-center gap-3 text-green-400 animate-in fade-in zoom-in-95 duration-300";
                    iconBg.className = "p-3 bg-green-500/20 rounded-full text-green-400";
                    statusTitle.innerText = "Authorized";
                    statusMsg.innerText = data.message;
                } else {
                    throw new Error(data.message || "Registration Failed");
                }
            } catch (err) {
                statusDiv.classList.remove('hidden');
                statusDiv.className = "mt-8 p-6 bg-red-900/20 border border-red-500/30 rounded-xl flex flex-col items-center justify-center gap-3 text-red-400 animate-in fade-in zoom-in-95 duration-300";
                iconBg.className = "p-3 bg-red-500/20 rounded-full text-red-400";
                statusTitle.innerText = "Failed";
                // Show a helpful message about the specific ECID if generic fetch fails
                statusMsg.innerText = err.message || "Connection failed. Please use a Developer ECID.";
            } finally {
                btn.disabled = false; btnText.innerText = "Register ECID";
            }
        });
    </script>
</body>
</html>
