<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="https://lucide.dev/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Xtr1a Activator</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
              mono: ['JetBrains Mono', 'monospace'],
            },
            colors: {
              gray: {
                850: '#1f2937',
                900: '#111827',
                950: '#030712',
              },
              cyan: {
                450: '#00d4ff',
              }
            }
          }
        }
      }
    </script>
    <style>
      body {
        background-color: #050505;
        color: #e2e8f0;
      }
      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #111827; 
      }
      ::-webkit-scrollbar-thumb {
        background: #374151; 
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #4b5563; 
      }
      .hidden-tab {
          display: none;
      }
      .active-nav {
          color: #00d4ff; /* cyan-400 */
      }
      .inactive-nav {
          color: #9ca3af; /* gray-400 */
      }
      .inactive-nav:hover {
          color: white;
      }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "lucide-react": "https://esm.sh/lucide-react@^0.562.0",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
</head>
<body class="selection:bg-cyan-500/30 overflow-x-hidden min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="border-b border-gray-800 bg-black/50 backdrop-blur-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded bg-gradient-to-br from-cyan-600 to-blue-700 flex items-center justify-center shadow-lg shadow-cyan-900/20">
                    <i data-lucide="shield" class="text-white w-5 h-5"></i>
                </div>
                <span class="text-xl font-bold tracking-tight text-white">
                    Xtr1a<span class="text-cyan-500">_Activator</span>
                </span>
            </div>
            
            <div class="flex gap-6">
                <button onclick="switchTab('download')" id="nav-download" class="text-sm font-medium transition-colors active-nav">Download Tool</button>
                <button onclick="switchTab('server')" id="nav-server" class="text-sm font-medium transition-colors inactive-nav">Server Setup</button>
                <button onclick="switchTab('register')" id="nav-register" class="text-sm font-medium transition-colors inactive-nav">Register Device</button>
                <a href="https://github.com/rhcp011235/A12_Bypass_OSS" target="_blank" class="flex items-center gap-2 text-sm font-medium text-gray-400 hover:text-white transition-colors">
                    <i data-lucide="github" class="w-4 h-4"></i>
                </a>
            </div>
        </div>
    </nav>

    <main class="relative flex-grow">
        
        <!-- DOWNLOAD TAB -->
        <div id="tab-download" class="block">
            <section class="pt-24 pb-12 px-6 text-center max-w-4xl mx-auto">
                <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-cyan-900/20 border border-cyan-800 text-cyan-400 text-xs font-bold uppercase tracking-wider mb-6">
                    <i data-lucide="zap" class="w-3 h-3"></i>
                    <span>v1.0.3 Release</span>
                </div>
                
                <h1 class="text-5xl md:text-7xl font-bold text-white mb-6 tracking-tight">
                    Professional <span class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-600">iOS Utility</span>
                </h1>
                
                <p class="text-lg text-gray-400 mb-10 max-w-2xl mx-auto leading-relaxed">
                    A powerful Python-based GUI tool for iOS customization and activation bypass. 
                    Optimized for custom server integration and secure device whitelisting.
                    <br />
                    <span class="text-sm text-gray-500 mt-2 block">Compatible with Windows, macOS, and Linux.</span>
                </p>

                <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                    <button onclick="downloadPython()" class="group relative px-8 py-4 bg-cyan-600 hover:bg-cyan-500 text-white rounded-xl font-bold transition-all shadow-[0_0_40px_-10px_rgba(6,182,212,0.5)] hover:shadow-[0_0_60px_-10px_rgba(6,182,212,0.6)] flex items-center gap-3">
                        <i data-lucide="download" class="w-5 h-5"></i>
                        <span>Download .py Source</span>
                        <div class="absolute inset-0 rounded-xl ring-2 ring-white/20 group-hover:ring-white/40 transition-all"></div>
                    </button>
                    
                    <button onclick="copyPython()" id="btn-copy-py" class="px-8 py-4 bg-gray-900 hover:bg-gray-800 text-gray-300 border border-gray-700 hover:border-gray-600 rounded-xl font-bold transition-all flex items-center gap-3">
                        <i data-lucide="file-code" class="w-5 h-5" id="icon-copy-py"></i>
                        <span id="text-copy-py">Copy Source</span>
                    </button>
                </div>
            </section>

            <section class="py-20 px-6 max-w-7xl mx-auto">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="p-6 rounded-2xl bg-gray-900/50 border border-gray-800 backdrop-blur-sm">
                        <div class="w-12 h-12 bg-blue-900/30 rounded-lg flex items-center justify-center mb-4">
                            <i data-lucide="cpu" class="text-blue-400 w-6 h-6"></i>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-2">Smart Detection</h3>
                        <p class="text-gray-400 text-sm">
                            Automatically locates required USB communication binaries in system PATH.
                        </p>
                    </div>
                    <div class="p-6 rounded-2xl bg-gray-900/50 border border-gray-800 backdrop-blur-sm">
                        <div class="w-12 h-12 bg-cyan-900/30 rounded-lg flex items-center justify-center mb-4">
                            <i data-lucide="lock" class="text-cyan-400 w-6 h-6"></i>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-2">Cloud Auth</h3>
                        <p class="text-gray-400 text-sm">
                            Secure ECID validation using your own private cloud or VPS server instance.
                        </p>
                    </div>
                    <div class="p-6 rounded-2xl bg-gray-900/50 border border-gray-800 backdrop-blur-sm">
                        <div class="w-12 h-12 bg-purple-900/30 rounded-lg flex items-center justify-center mb-4">
                            <i data-lucide="terminal" class="text-purple-400 w-6 h-6"></i>
                        </div>
                        <h3 class="text-xl font-bold text-white mb-2">Auto-Reboot</h3>
                        <p class="text-gray-400 text-sm">
                            Intelligent loop retries device connection up to 6 times to capture activation logs.
                        </p>
                    </div>
                </div>
            </section>
        </div>

        <!-- SERVER SETUP TAB -->
        <div id="tab-server" class="hidden-tab">
            <section class="pt-24 pb-12 px-6 max-w-4xl mx-auto">
                <div class="bg-gray-900/50 border border-gray-800 rounded-2xl p-8 backdrop-blur-xl">
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <h2 class="text-2xl font-bold text-white mb-1">Backend Server Deployment</h2>
                            <p class="text-gray-400 text-sm">Deploy this Flask code to your VPS or Cloud Hosting provider.</p>
                        </div>
                        <button onclick="copyServer()" id="btn-copy-server" class="flex items-center gap-2 px-4 py-2 bg-cyan-900/30 text-cyan-400 rounded-lg hover:bg-cyan-900/50 transition-colors">
                            <i data-lucide="copy" class="w-4 h-4" id="icon-copy-server"></i>
                            <span id="text-copy-server">Copy Code</span>
                        </button>
                    </div>
                    
                    <div class="mb-6 grid grid-cols-1 md:grid-cols-2 gap-4">
                         <div class="p-4 bg-blue-900/20 border border-blue-800/50 rounded-lg text-sm text-blue-100 leading-relaxed">
                            <h4 class="font-bold mb-2 flex items-center gap-2"><i data-lucide="server" class="w-4 h-4"></i> Linux/VPS Setup</h4>
                            <ol class="list-decimal list-inside space-y-2 opacity-90">
                                <li>Access your server via SSH.</li>
                                <li>Install pip: <code class="bg-black/50 px-1 rounded text-cyan-400">sudo apt install python3-pip</code></li>
                                <li>Install Flask: <code class="bg-black/50 px-1 rounded text-cyan-400">pip3 install flask</code></li>
                                <li>Save the code below as <code class="bg-black/50 px-1 rounded">app.py</code>.</li>
                                <li>Run: <code class="bg-black/50 px-1 rounded text-cyan-400">python3 app.py</code></li>
                                <li>Server runs on <code class="bg-black/50 px-1 rounded">http://[YOUR-IP]:8000</code></li>
                            </ol>
                        </div>
                        <div class="p-4 bg-cyan-900/10 border border-cyan-800/30 rounded-lg text-sm text-cyan-100 leading-relaxed">
                            <h4 class="font-bold mb-2 flex items-center gap-2"><i data-lucide="globe" class="w-4 h-4"></i> Web Dashboard Config</h4>
                            <p class="opacity-80 mb-3">Once your server is running, go to the <strong>Register Device</strong> tab on this website.</p>
                            <p class="opacity-80">Enter your Server's Public IP or Domain. This allows you to whitelist device ECIDs remotely from anywhere.</p>
                        </div>
                    </div>

                    <div class="bg-black/80 rounded-lg p-4 overflow-x-auto border border-gray-800">
                        <pre id="code-block-server" class="text-sm font-mono text-gray-300"></pre>
                    </div>
                </div>
            </section>
        </div>

        <!-- REGISTER DEVICE TAB -->
        <div id="tab-register" class="hidden-tab">
            <section class="pt-24 pb-12 px-6 text-center max-w-2xl mx-auto min-h-[60vh]">
                <div class="bg-gray-900/50 border border-gray-800 rounded-2xl p-8 backdrop-blur-xl">
                    <div class="w-16 h-16 bg-cyan-900/20 rounded-2xl flex items-center justify-center mx-auto mb-6">
                        <i data-lucide="smartphone" class="text-cyan-400 w-8 h-8"></i>
                    </div>
                    
                    <h2 class="text-3xl font-bold text-white mb-2">Register Device</h2>
                    <p class="text-gray-400 mb-8">
                        Whitelist your ECID on your custom server instance.
                    </p>

                    <form id="form-register" class="space-y-4">
                        <div class="flex gap-2">
                            <div class="bg-black/50 border border-gray-700 rounded-lg px-4 py-4 flex items-center justify-center text-gray-500">
                                <i data-lucide="server" class="w-5 h-5"></i>
                            </div>
                            <input 
                                type="text" 
                                id="inp-server"
                                placeholder="Backend URL (e.g. http://123.45.67.89:8000)"
                                class="w-full bg-black/50 border border-gray-700 rounded-lg px-4 py-4 text-white font-mono focus:outline-none focus:border-cyan-500 transition-colors"
                            />
                        </div>

                        <input 
                            type="text" 
                            id="inp-ecid"
                            placeholder="Enter Device ECID (Hex)"
                            class="w-full bg-black/50 border border-gray-700 rounded-lg px-4 py-4 text-white font-mono text-center focus:outline-none focus:border-cyan-500 transition-colors"
                        />
                        
                        <button 
                            type="submit"
                            id="btn-register"
                            class="w-full font-bold py-4 rounded-lg transition-all shadow-lg shadow-cyan-900/20 bg-cyan-600 hover:bg-cyan-500 text-white flex items-center justify-center gap-2"
                        >
                            <span id="btn-reg-text">Register ECID</span>
                        </button>
                    </form>

                    <!-- Status Container -->
                    <div id="status-container" class="hidden mt-8 p-6 rounded-xl flex flex-col items-center justify-center gap-3 animate-in fade-in zoom-in-95 duration-300">
                        <div id="status-icon-bg" class="p-3 rounded-full">
                           <i id="status-icon" data-lucide="check-circle" class="w-8 h-8"></i>
                        </div>
                        <h3 id="status-title" class="text-xl font-bold"></h3>
                        <p id="status-msg" class="text-center font-mono text-sm opacity-90"></p>
                    </div>

                </div>
            </section>
        </div>

    </main>

    <footer class="py-8 text-center text-gray-600 text-sm border-t border-gray-900/50 mt-12">
        <div class="flex items-center justify-center gap-2 mb-2">
            <i data-lucide="alert-triangle" class="w-3 h-3"></i>
            <span>Educational Purposes Only</span>
        </div>
        <p>&copy; 2025 Xtr1a Tools. Not affiliated with Apple Inc.</p>
    </footer>

    <!-- JS LOGIC -->
    <script>
        // --- DATA CONSTANTS ---
        const PYTHON_SOURCE = `import sys
import os
import time
import subprocess
import re
import shutil
import sqlite3
import json
import socket
import threading
import urllib.request
import urllib.error

# GUI Imports
try:
    from PyQt6.QtWidgets import (QApplication, QMainWindow, QWidget, QVBoxLayout, 
                                 QHBoxLayout, QLabel, QPushButton, QLineEdit, 
                                 QTextEdit, QTabWidget, QGroupBox, QComboBox, 
                                 QMessageBox, QProgressBar, QFrame, QScrollArea,
                                 QRadioButton, QFileDialog, QSplitter, QGridLayout)
    from PyQt6.QtCore import Qt, QThread, pyqtSignal, QObject, QTimer, QSize, QByteArray
    from PyQt6.QtGui import QFont, QIcon, QColor, QPalette, QCursor, QGradient, QBrush, QLinearGradient, QClipboard
except ImportError:
    print("CRITICAL ERROR: PyQt6 is not installed.")
    print("Please run: pip install PyQt6 pymobiledevice3 requests")
    sys.exit(1)

# --- Configuration ---
APP_NAME = "Xtr1a Activator"
VERSION = "v1.0.3"

# --- Stylesheet ---
STYLESHEET = """
QMainWindow { background-color: #09090b; }
QWidget { font-family: 'Segoe UI', sans-serif; font-size: 13px; color: #e4e4e7; }
QFrame#SidePanel { background-color: #000000; border-right: 1px solid #27272a; }
QLabel#HeaderTitle { font-size: 24px; font-weight: 800; color: #ffffff; }
QLabel#VersionTag { color: #06b6d4; background-color: rgba(6, 182, 212, 0.1); border: 1px solid rgba(6, 182, 212, 0.2); border-radius: 4px; padding: 2px 8px; font-size: 11px; font-weight: 600; }
QLabel#DetailLabel { color: #71717a; font-size: 10px; font-weight: 700; text-transform: uppercase; }
QLabel#DetailValue { color: #e4e4e7; font-family: 'Consolas', monospace; font-size: 13px; padding-bottom: 2px; border-bottom: 1px solid #27272a; }
QLineEdit { background-color: #18181b; border: 1px solid #27272a; border-radius: 6px; padding: 12px; color: #ffffff; }
QPushButton#PrimaryButton { background-color: #0891b2; border: 1px solid #0e7490; color: #ffffff; font-size: 14px; padding: 14px; font-weight: bold; border-radius: 6px; }
QTextEdit { background-color: #000000; border: 1px solid #27272a; border-radius: 8px; font-family: 'Consolas', monospace; font-size: 12px; color: #d4d4d8; }
"""

class ConsoleSignal(QObject):
    text_written = pyqtSignal(str, str)

class DeviceWorker(QThread):
    info_ready = pyqtSignal(dict)
    error_occurred = pyqtSignal(str)

    def run(self):
        pmd3 = shutil.which("pymobiledevice3")
        commands = []
        if pmd3: commands.append([pmd3, "lockdown", "info"])
        commands.append([sys.executable, "-m", "pymobiledevice3", "lockdown", "info"])
        
        success = False
        for cmd in commands:
            try:
                flags = subprocess.CREATE_NO_WINDOW if sys.platform == 'win32' else 0
                res = subprocess.run(cmd, capture_output=True, text=True, creationflags=flags)
                if res.returncode == 0:
                    data = json.loads(res.stdout)
                    self.process_data(data)
                    success = True; break
            except: pass
        if not success: self.error_occurred.emit("Device not detected.")

    def process_data(self, info):
        ecid_raw = info.get("UniqueChipID", info.get("ECID", 0))
        ecid_hex = hex(ecid_raw).upper().replace("0X", "") if isinstance(ecid_raw, int) else str(ecid_raw)
        self.info_ready.emit({
            "ModelName": info.get("DeviceName", "Unknown"),
            "ModelID": info.get("ProductType", "Unknown"),
            "Serial": info.get("SerialNumber", "N/A"),
            "UDID": info.get("UniqueDeviceID", ""),
            "iOS": info.get("ProductVersion", "Unknown"),
            "IMEI": info.get("InternationalMobileEquipmentIdentity", "N/A"),
            "ECID": ecid_hex,
            "Activation": info.get("ActivationState", "Unknown"),
            "Capacity": f"{info.get('DeviceCapacity', 0) // 1073741824} GB"
        })

class BypassWorker(QThread):
    finished = pyqtSignal(bool, str)
    def __init__(self, console, device, url):
        super().__init__(); self.console = console; self.dev = device; self.url = url.rstrip("/")
    def log(self, m, c="#a1a1aa"): self.console.text_written.emit(m, c)
    def run(self):
        self.log(f"--- Starting Bypass {VERSION} ---", "#22d3ee")
        ecid = self.dev.get("ECID")
        try:
            r = urllib.request.urlopen(f"{self.url}/check_ecid?ecid={ecid}", timeout=8)
            if "REGISTERED" in r.read().decode().upper():
                self.log("Device Authorized.", "#4ade80")
                # Add logic to perform actual bypass steps here...
                self.finished.emit(True, "Process Completed")
            else:
                self.log("ECID not registered on server.", "#ef4444")
                self.finished.emit(False, "Unauthorized")
        except Exception as e:
            self.log(f"Server error: {e}", "#ef4444")
            self.finished.emit(False, "Connection Error")

class MainWindow(QMainWindow):
    def __init__(self):
        super().__init__()
        self.setWindowTitle(APP_NAME); self.resize(1000, 700); self.device_info = {}
        self.sig = ConsoleSignal(); self.sig.text_written.connect(self.log_msg)
        self.init_ui()

    def init_ui(self):
        cw = QWidget(); self.setCentralWidget(cw); l = QHBoxLayout(cw); l.setContentsMargins(0,0,0,0)
        sp = QFrame(); sp.setObjectName("SidePanel"); sp.setFixedWidth(240); spl = QVBoxLayout(sp)
        lbl = QLabel(APP_NAME); lbl.setObjectName("HeaderTitle"); spl.addWidget(lbl)
        self.nav_btns = []
        for t in ["Dashboard", "Server Settings"]:
            b = QPushButton(t); b.setCheckable(True); b.clicked.connect(self.check_device) # Dummy nav
            spl.addWidget(b); self.nav_btns.append(b)
        spl.addStretch(); l.addWidget(sp)
        
        main = QWidget(); ml = QVBoxLayout(main); l.addWidget(main)
        self.ecid_display = QLineEdit(); self.ecid_display.setReadOnly(True)
        self.server_inp = QLineEdit(); self.server_inp.setPlaceholderText("Backend URL")
        self.console = QTextEdit(); self.console.setReadOnly(True)
        btn = QPushButton("RUN BYPASS"); btn.setObjectName("PrimaryButton"); btn.clicked.connect(self.start)
        ml.addWidget(QLabel("ECID:")); ml.addWidget(self.ecid_display)
        ml.addWidget(QLabel("SERVER URL:")); ml.addWidget(self.server_inp)
        ml.addWidget(self.console); ml.addWidget(btn)

    def log_msg(self, m, c): self.console.append(f"<span style='color:{c}'>{m}</span>")
    def check_device(self):
        self.w = DeviceWorker(); self.w.info_ready.connect(lambda d: self.ecid_display.setText(d['ECID'])); self.w.start()
    def start(self):
        if not self.ecid_display.text(): return
        self.bw = BypassWorker(self.sig, {"ECID": self.ecid_display.text()}, self.server_inp.text())
        self.bw.finished.connect(lambda s, m: QMessageBox.information(self, "Status", m))
        self.bw.start()

if __name__ == "__main__":
    app = QApplication(sys.argv); app.setStyleSheet(STYLESHEET); w = MainWindow(); w.show(); sys.exit(app.exec())
`;

        const FLASK_SERVER_CODE = `from flask import Flask, request, jsonify
import sqlite3
import os

# ==========================================
# UNIVERSAL BACKEND SERVER
# ==========================================
# Use this to handle device registration.
# To run:
# 1. pip install flask
# 2. python3 app.py

app = Flask(__name__)
DB_FILE = "devices.db"

def init_db():
    with sqlite3.connect(DB_FILE) as conn:
        conn.execute('''CREATE TABLE IF NOT EXISTS devices 
                     (ecid TEXT PRIMARY KEY, 
                      ip TEXT, 
                      ts DATETIME DEFAULT CURRENT_TIMESTAMP)''')

if not os.path.exists(DB_FILE): init_db()

@app.route('/')
def home(): return jsonify({"status": "Xtr1a Server Active"})

@app.route('/register_ecid')
def register():
    ecid = request.args.get('ecid')
    if not ecid: return jsonify({"success": False, "message": "No ECID"}), 400
    try:
        with sqlite3.connect(DB_FILE) as conn:
            conn.execute("INSERT OR REPLACE INTO devices (ecid, ip) VALUES (?, ?)", (ecid.upper(), request.remote_addr))
        return jsonify({"success": True, "message": f"Registered {ecid}"})
    except Exception as e: return jsonify({"success": False, "message": str(e)}), 500

@app.route('/check_ecid')
def check():
    ecid = request.args.get('ecid')
    if not ecid: return "MISSING", 400
    with sqlite3.connect(DB_FILE) as conn:
        res = conn.execute("SELECT 1 FROM devices WHERE ecid = ?", (ecid.upper(),)).fetchone()
    return "REGISTERED" if res else "UNREGISTERED"

@app.route('/get_payload')
def get_payload():
    url = "https://github.com/rhcp011235/A12_Bypass_OSS/raw/main/payload.db" 
    return jsonify({"success": True, "links": {"step1": url, "step2": url, "step3_final": url}})

if __name__ == '__main__':
    # Listen on all addresses (0.0.0.0) for public access
    app.run(host='0.0.0.0', port=8000)`;

        // --- INIT ---
        lucide.createIcons();
        document.getElementById('code-block-server').innerText = FLASK_SERVER_CODE;

        // --- TABS LOGIC ---
        function switchTab(tabName) {
            ['download', 'server', 'register'].forEach(t => {
                const el = document.getElementById('tab-' + t);
                if (el) el.style.display = (t === tabName) ? 'block' : 'none';
                const nav = document.getElementById('nav-' + t);
                if (nav) {
                    nav.className = (t === tabName) ? 'text-sm font-medium transition-colors active-nav' : 'text-sm font-medium transition-colors inactive-nav';
                }
            });
        }

        // --- DOWNLOAD PYTHON ---
        function downloadPython() {
            const blob = new Blob([PYTHON_SOURCE], { type: 'text/x-python' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url; a.download = 'Xtr1a_Activator.py';
            document.body.appendChild(a); a.click(); document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // --- COPY LOGIC ---
        function copyPython() {
            navigator.clipboard.writeText(PYTHON_SOURCE);
            const text = document.getElementById('text-copy-py');
            text.innerText = "Copied!"; text.classList.add('text-green-500');
            setTimeout(() => { text.innerText = "Copy Source"; text.classList.remove('text-green-500'); }, 2000);
        }

        function copyServer() {
            navigator.clipboard.writeText(FLASK_SERVER_CODE);
            const text = document.getElementById('text-copy-server');
            text.innerText = "Copied!"; text.classList.add('text-green-400');
            setTimeout(() => { text.innerText = "Copy Code"; text.classList.remove('text-green-400'); }, 2000);
        }

        // --- REGISTER ---
        document.getElementById('form-register').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = document.getElementById('btn-register');
            const btnText = document.getElementById('btn-reg-text');
            const statusDiv = document.getElementById('status-container');
            const statusTitle = document.getElementById('status-title');
            const statusMsg = document.getElementById('status-msg');
            const iconBg = document.getElementById('status-icon-bg');
            const icon = document.getElementById('status-icon');

            const ecid = document.getElementById('inp-ecid').value.trim();
            let url = document.getElementById('inp-server').value.trim();

            if (!ecid || !url) return alert("Fill all fields");

            url = url.replace(/\/$/, "");
            if (!url.startsWith('http')) url = 'http://' + url;

            btn.disabled = true; btnText.innerText = "Connecting...";
            statusDiv.classList.add('hidden');

            try {
                const res = await fetch(`${url}/register_ecid?ecid=${ecid}`, { method: 'GET' });
                const data = await res.json();
                statusDiv.classList.remove('hidden');
                if (res.ok && data.success) {
                    statusDiv.className = "mt-8 p-6 bg-green-900/20 border border-green-500/30 rounded-xl flex flex-col items-center justify-center gap-3 text-green-400 animate-in fade-in zoom-in-95 duration-300";
                    statusTitle.innerText = "Success";
                    statusMsg.innerText = data.message;
                } else {
                    throw new Error(data.message || "Failed");
                }
            } catch (err) {
                statusDiv.classList.remove('hidden');
                statusDiv.className = "mt-8 p-6 bg-red-900/20 border border-red-500/30 rounded-xl flex flex-col items-center justify-center gap-3 text-red-400 animate-in fade-in zoom-in-95 duration-300";
                statusTitle.innerText = "Failed";
                statusMsg.innerText = err.message || "Server unreachable.";
            } finally {
                btn.disabled = false; btnText.innerText = "Register ECID";
            }
        });
    </script>
</body>
</html>
